# Водий бозор бот
Ушбу бот "Водий бозор" телеграм канали админлари буюртмаси асосида ишлаб чиқилмоқда

## Ботга қўйилган асосий талаблар:
* максимум даражада тез ишлаши ва фойдаланувчига тез жавоб қайтариш;
* жудаям оддий ва содда интерфейсга эга бўлиши;
* интерфаол тартибда ишлаши;
* эълон берувчига қулайлик яратиш;
* элон ҳақида админга ўз вақтида етказиш;

## Серверга ўрнатиш учун талаблар

### Асосий талаблар
* Python 3.6 дастурлаш тили
* Postgresql 9.6 маълумотлар базаси

### Модуллар
* asyncio
* aiohttp
* uvloop
* aiotg
* asyncpg
* aiobotocore

## Муҳит ўзгарувчилари
* API_TOKEN - бот учун берилган токен
* BOT_NAME - бот номи
* DATABASE_URL - Postgresqlга уланиш параметрлари
* AWS_ACCESS_KEY_ID - AWS маҳфий калитлар
* AWS_SECRET_ACCESS_KEY - AWS маҳфий калитлар

## Ботни ишлаш принциплари:
1. Ботга мурожаат қилган ҳар қайси фойдаланувчини базага киритиш;
2. Қабул қилинган эълонни базага киритиб, дарҳол админларга бу ҳақда хабар бериш;
3. Админ (лардан бири) рухсат бериши билан эълонни каналга чоп этиш;
4. Каналга чоп этилганлиги ҳақида эълон эгасига хабар бериш;
5. Базадаги (сотилмаган!) маҳсулотларни тасодиф (бетартиб) тарзда каналга ҳар ярим соатда чоп этиб туриш;
6. Базадаги сотилмаган маҳсулотларни эълон берувчидан маълум вақт орасида (3 кунда 1 марта) сотилган ёки сотилмагани ҳақида сўраш;

## Бот архитектураси

     .───────────────────────────────────────.         .─────────────────────.
    (           Postgresql базаси             )       (       Amazon S3       )
     `───────────────────────────────────────'         `─────────────────────'
                         △                                        △
                        ┌┘                                        │
    ┌ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┼ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┼ ─ ─ ─ ─ ─ ┐  ┌────────┐
                        ▽        asyncio + uvloop                 ▽              │        │
    │    ┌────────────────────────────┐ ┌────────────────┐ ┌─────────────┐    │  │        │
         │                            │ │                │ │             │       │        │
    │    │                            │ │       AI       │ │             │    │  │Телеграм│
         │                            │ │                │ │             │       │ канал  │◀─┐
    │ ┌─▷│          asyncpg           │ │                │ │ aiobotocore │◁─┐ │  │        │  │
      │  │                            │ └────────────────┘ │             │  │    │        │  │
    │ │  │                            │          ●         │             │  │ │  │        │  │
      │  │                            │   ─ ─ ─ ─          │             │  │    └────────┘  │
    │ │  └────────────────────────────┘  ●                 └─────────────┘  │ │       ▲      │
      │  ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓  │         │      │
    │ │  ┃                                                               ┃  │ │       │      │
      └─▷┃                Бот (asyncio + aiotg + aiohttp)                ┃──┴─────────┘      │
    │    ┃                                                               ┃    │              │
         ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛                   │
    │                                    ▲                                    │              │
     ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┼ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─               │
                ┌────────────────────────┼────────────────────────┐                          │
                │                        │                        │                          │
                ▼                        ▼                        ▼                          │
    ┏━━━━━━━━━━━━━━━━━━━━━━━┓ ┏━━━━━━━━━━━━━━━━━━━━┓ ┏━━━━━━━━━━━━━━━━━━━━━━━━┓              │
    ┃                       ┃ ┃                    ┃ ┃                        ┃              │
    ┃         Админ         ┃ ┃   Эълон берувчи    ┃ ┃      Фойдаланувчи      ┃◀─────────────┘
    ┃                       ┃ ┃                    ┃ ┃                        ┃
    ┗━━━━━━━━━━━━━━━━━━━━━━━┛ ┗━━━━━━━━━━━━━━━━━━━━┛ ┗━━━━━━━━━━━━━━━━━━━━━━━━┛
